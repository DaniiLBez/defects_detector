<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="1057px" preserveAspectRatio="none" style="width:1856px;height:1057px;background:#FFFFFF;" version="1.1" viewBox="0 0 1856 1057" width="1856px" zoomAndPan="magnify"><defs/><g><!--class RGBModel--><g id="elem_RGBModel"><rect codeLine="2" fill="#F1F1F1" height="178.3477" id="RGBModel" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="657.9277" x="7" y="466"/><ellipse cx="297.4795" cy="482" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M300.2451,477.875 Q300.4014,477.6563 300.5889,477.5469 Q300.7764,477.4375 300.9951,477.4375 Q301.3701,477.4375 301.6045,477.7031 Q301.8389,477.9531 301.8389,478.5625 L301.8389,480.0156 Q301.8389,480.625 301.6045,480.8906 Q301.3701,481.1563 300.9951,481.1563 Q300.6514,481.1563 300.4482,480.9531 Q300.2451,480.7656 300.1357,480.25 Q300.0889,479.8906 299.9014,479.7031 Q299.5732,479.3281 298.9639,479.1094 Q298.3545,478.8906 297.7295,478.8906 Q296.9639,478.8906 296.3232,479.2188 Q295.6982,479.5469 295.1982,480.2969 Q294.7139,481.0469 294.7139,482.0781 L294.7139,483.1719 Q294.7139,484.4063 295.6045,485.2344 Q296.4951,486.0469 298.0889,486.0469 Q299.0264,486.0469 299.6826,485.7969 Q300.0732,485.6406 300.4951,485.2031 Q300.7607,484.9375 300.9014,484.8594 Q301.0576,484.7813 301.2607,484.7813 Q301.5889,484.7813 301.8389,485.0469 Q302.1045,485.2969 302.1045,485.6406 Q302.1045,485.9844 301.7607,486.3906 Q301.2607,486.9688 300.4639,487.2969 Q299.3857,487.75 298.0889,487.75 Q296.5732,487.75 295.3701,487.125 Q294.3857,486.625 293.6982,485.5625 Q293.0107,484.4844 293.0107,483.2031 L293.0107,482.0469 Q293.0107,480.7188 293.6201,479.5781 Q294.2451,478.4219 295.3389,477.8125 Q296.4326,477.1875 297.667,477.1875 Q298.4014,477.1875 299.042,477.3594 Q299.6982,477.5156 300.2451,477.875 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="68.4688" x="317.9795" y="487.7969">RGBModel</text><line style="stroke:#181818;stroke-width:0.5;" x1="8" x2="663.9277" y1="498" y2="498"/><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="15" y="509.8105"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="98.8271" x="27" y="517.1074">_device: Device</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="15" y="528.4316"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="147.8408" x="27" y="535.7285">backbone: timm.models</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="15" y="547.0527"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="241.2813" x="27" y="554.3496">avg_pool: torch.nn.AdaptiveAvgPool2d</text><ellipse cx="18" cy="568.6738" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="91.041" x="27" y="572.9707">device: Device</text><line style="stroke:#181818;stroke-width:0.5;" x1="8" x2="663.9277" y1="580.4844" y2="580.4844"/><ellipse cx="18" cy="595.2949" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="631.9277" x="27" y="599.5918">__init__(device: Device, backbone_name: str, out_indices: tuple, checkpoint_path: str, pool_last: bool)</text><ellipse cx="18" cy="613.916" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="174.2617" x="27" y="618.2129">forward(x: torch.Tensor): list</text><ellipse cx="18" cy="632.5371" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="326.8193" x="27" y="636.834">freeze_parameters(layers: list, freeze_bn: bool): void</text></g><!--class Device--><g id="elem_Device"><rect codeLine="13" fill="#F1F1F1" height="85.2422" id="Device" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="107.9219" x="1285" y="7"/><ellipse cx="1314.908" cy="23" fill="#EB937F" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M1313.7674,23.7969 L1313.7674,26.2969 L1318.0955,26.2969 L1318.0955,25.375 Q1318.0955,24.7656 1318.3299,24.5 Q1318.5799,24.2344 1318.9549,24.2344 Q1319.3299,24.2344 1319.5643,24.5 Q1319.7986,24.7656 1319.7986,25.375 L1319.7986,28 L1311.7986,28 Q1311.1736,28 1310.908,27.7656 Q1310.658,27.5313 1310.658,27.1406 Q1310.658,26.7656 1310.9236,26.5313 Q1311.1893,26.2969 1311.7986,26.2969 L1312.0643,26.2969 L1312.0643,19.6406 L1311.7986,19.6406 Q1311.1736,19.6406 1310.908,19.4063 Q1310.658,19.1719 1310.658,18.7813 Q1310.658,18.4063 1310.908,18.1719 Q1311.1736,17.9375 1311.7986,17.9375 L1319.4236,17.9375 L1319.4236,20.5313 Q1319.4236,21.1406 1319.1893,21.4063 Q1318.9705,21.6563 1318.5799,21.6563 Q1318.2049,21.6563 1317.9705,21.4063 Q1317.7361,21.1406 1317.7361,20.5313 L1317.7361,19.6406 L1313.7674,19.6406 L1313.7674,22.0938 L1315.2518,22.0938 Q1315.2518,21.4375 1315.3768,21.25 Q1315.6424,20.8438 1316.1111,20.8438 Q1316.4861,20.8438 1316.7205,21.1094 Q1316.9549,21.3594 1316.9549,21.9688 L1316.9549,23.9375 Q1316.9549,24.4844 1316.8299,24.6719 Q1316.5643,25.0625 1316.1111,25.0625 Q1315.6424,25.0625 1315.3768,24.6563 Q1315.2518,24.4688 1315.2518,23.7969 L1313.7674,23.7969 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="42.793" x="1332.2209" y="28.7969">Device</text><line style="stroke:#181818;stroke-width:0.5;" x1="1286" x2="1391.9219" y1="39" y2="39"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="78.0254" x="1291" y="58.1074">CPU = "cpu"</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="95.9219" x="1291" y="76.7285">CUDA = "cuda"</text><line style="stroke:#181818;stroke-width:0.5;" x1="1286" x2="1391.9219" y1="84.2422" y2="84.2422"/></g><!--class PointEncoder--><g id="elem_PointEncoder"><rect codeLine="18" fill="#F1F1F1" height="271.4531" id="PointEncoder" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="285.9297" x="591" y="779"/><ellipse cx="687.6875" cy="795" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M690.4531,790.875 Q690.6094,790.6563 690.7969,790.5469 Q690.9844,790.4375 691.2031,790.4375 Q691.5781,790.4375 691.8125,790.7031 Q692.0469,790.9531 692.0469,791.5625 L692.0469,793.0156 Q692.0469,793.625 691.8125,793.8906 Q691.5781,794.1563 691.2031,794.1563 Q690.8594,794.1563 690.6563,793.9531 Q690.4531,793.7656 690.3438,793.25 Q690.2969,792.8906 690.1094,792.7031 Q689.7813,792.3281 689.1719,792.1094 Q688.5625,791.8906 687.9375,791.8906 Q687.1719,791.8906 686.5313,792.2188 Q685.9063,792.5469 685.4063,793.2969 Q684.9219,794.0469 684.9219,795.0781 L684.9219,796.1719 Q684.9219,797.4063 685.8125,798.2344 Q686.7031,799.0469 688.2969,799.0469 Q689.2344,799.0469 689.8906,798.7969 Q690.2813,798.6406 690.7031,798.2031 Q690.9688,797.9375 691.1094,797.8594 Q691.2656,797.7813 691.4688,797.7813 Q691.7969,797.7813 692.0469,798.0469 Q692.3125,798.2969 692.3125,798.6406 Q692.3125,798.9844 691.9688,799.3906 Q691.4688,799.9688 690.6719,800.2969 Q689.5938,800.75 688.2969,800.75 Q686.7813,800.75 685.5781,800.125 Q684.5938,799.625 683.9063,798.5625 Q683.2188,797.4844 683.2188,796.2031 L683.2188,795.0469 Q683.2188,793.7188 683.8281,792.5781 Q684.4531,791.4219 685.5469,790.8125 Q686.6406,790.1875 687.875,790.1875 Q688.6094,790.1875 689.25,790.3594 Q689.9063,790.5156 690.4531,790.875 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="84.0547" x="708.1875" y="800.7969">PointEncoder</text><line style="stroke:#181818;stroke-width:0.5;" x1="592" x2="875.9297" y1="811" y2="811"/><ellipse cx="602" cy="825.8105" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="112.8545" x="611" y="830.1074">conv1: nn.Conv1d</text><ellipse cx="602" cy="844.4316" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="112.8545" x="611" y="848.7285">conv2: nn.Conv1d</text><ellipse cx="602" cy="863.0527" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="112.8545" x="611" y="867.3496">conv3: nn.Conv1d</text><ellipse cx="602" cy="881.6738" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="84.834" x="611" y="885.9707">fc1: nn.Linear</text><ellipse cx="602" cy="900.2949" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="84.834" x="611" y="904.5918">fc2: nn.Linear</text><ellipse cx="602" cy="918.916" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="136.1924" x="611" y="923.2129">bn1: nn.BatchNorm1d</text><ellipse cx="602" cy="937.5371" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="136.1924" x="611" y="941.834">bn2: nn.BatchNorm1d</text><ellipse cx="602" cy="956.1582" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="136.1924" x="611" y="960.4551">bn3: nn.BatchNorm1d</text><ellipse cx="602" cy="974.7793" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="136.1924" x="611" y="979.0762">bn4: nn.BatchNorm1d</text><ellipse cx="602" cy="993.4004" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="136.1924" x="611" y="997.6973">bn5: nn.BatchNorm1d</text><line style="stroke:#181818;stroke-width:0.5;" x1="592" x2="875.9297" y1="1005.2109" y2="1005.2109"/><ellipse cx="602" cy="1020.0215" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="259.9297" x="611" y="1024.3184">__init__(in_channels: int, feature_dim: int)</text><ellipse cx="602" cy="1038.6426" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="235.7373" x="611" y="1042.9395">forward(x: torch.Tensor): torch.Tensor</text></g><!--class NeuralImplicitField--><g id="elem_NeuralImplicitField"><rect codeLine="34" fill="#F1F1F1" height="178.3477" id="NeuralImplicitField" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="467.9844" x="912" y="825.5"/><ellipse cx="1084.1699" cy="841.5" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M1086.9355,837.375 Q1087.0918,837.1563 1087.2793,837.0469 Q1087.4668,836.9375 1087.6855,836.9375 Q1088.0605,836.9375 1088.2949,837.2031 Q1088.5293,837.4531 1088.5293,838.0625 L1088.5293,839.5156 Q1088.5293,840.125 1088.2949,840.3906 Q1088.0605,840.6563 1087.6855,840.6563 Q1087.3418,840.6563 1087.1387,840.4531 Q1086.9355,840.2656 1086.8262,839.75 Q1086.7793,839.3906 1086.5918,839.2031 Q1086.2637,838.8281 1085.6543,838.6094 Q1085.0449,838.3906 1084.4199,838.3906 Q1083.6543,838.3906 1083.0137,838.7188 Q1082.3887,839.0469 1081.8887,839.7969 Q1081.4043,840.5469 1081.4043,841.5781 L1081.4043,842.6719 Q1081.4043,843.9063 1082.2949,844.7344 Q1083.1855,845.5469 1084.7793,845.5469 Q1085.7168,845.5469 1086.373,845.2969 Q1086.7637,845.1406 1087.1855,844.7031 Q1087.4512,844.4375 1087.5918,844.3594 Q1087.748,844.2813 1087.9512,844.2813 Q1088.2793,844.2813 1088.5293,844.5469 Q1088.7949,844.7969 1088.7949,845.1406 Q1088.7949,845.4844 1088.4512,845.8906 Q1087.9512,846.4688 1087.1543,846.7969 Q1086.0762,847.25 1084.7793,847.25 Q1083.2637,847.25 1082.0605,846.625 Q1081.0762,846.125 1080.3887,845.0625 Q1079.7012,843.9844 1079.7012,842.7031 L1079.7012,841.5469 Q1079.7012,840.2188 1080.3105,839.0781 Q1080.9355,837.9219 1082.0293,837.3125 Q1083.123,836.6875 1084.3574,836.6875 Q1085.0918,836.6875 1085.7324,836.8594 Q1086.3887,837.0156 1086.9355,837.375 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="115.1445" x="1104.6699" y="847.2969">NeuralImplicitField</text><line style="stroke:#181818;stroke-width:0.5;" x1="913" x2="1378.9844" y1="857.5" y2="857.5"/><ellipse cx="923" cy="872.3105" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="84.834" x="932" y="876.6074">fc1: nn.Linear</text><ellipse cx="923" cy="890.9316" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="84.834" x="932" y="895.2285">fc2: nn.Linear</text><ellipse cx="923" cy="909.5527" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="84.834" x="932" y="913.8496">fc3: nn.Linear</text><ellipse cx="923" cy="928.1738" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="104.2959" x="932" y="932.4707">fc_out: nn.Linear</text><line style="stroke:#181818;stroke-width:0.5;" x1="913" x2="1378.9844" y1="939.9844" y2="939.9844"/><ellipse cx="923" cy="954.7949" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="154.8613" x="932" y="959.0918">__init__(feature_dim: int)</text><ellipse cx="923" cy="973.416" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="410.8262" x="932" y="977.7129">forward(features: torch.Tensor, points: torch.Tensor): torch.Tensor</text><ellipse cx="923" cy="992.0371" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="441.9844" x="932" y="996.334">get_gradient(features: torch.Tensor, points: torch.Tensor): torch.Tensor</text></g><!--class SDFModel--><g id="elem_SDFModel"><rect codeLine="45" fill="#F1F1F1" height="196.9688" id="SDFModel" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="478.874" x="700.5" y="456.5"/><ellipse cx="902.6216" cy="472.5" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M905.3872,468.375 Q905.5435,468.1563 905.731,468.0469 Q905.9185,467.9375 906.1372,467.9375 Q906.5122,467.9375 906.7466,468.2031 Q906.981,468.4531 906.981,469.0625 L906.981,470.5156 Q906.981,471.125 906.7466,471.3906 Q906.5122,471.6563 906.1372,471.6563 Q905.7935,471.6563 905.5903,471.4531 Q905.3872,471.2656 905.2778,470.75 Q905.231,470.3906 905.0435,470.2031 Q904.7153,469.8281 904.106,469.6094 Q903.4966,469.3906 902.8716,469.3906 Q902.106,469.3906 901.4653,469.7188 Q900.8403,470.0469 900.3403,470.7969 Q899.856,471.5469 899.856,472.5781 L899.856,473.6719 Q899.856,474.9063 900.7466,475.7344 Q901.6372,476.5469 903.231,476.5469 Q904.1685,476.5469 904.8247,476.2969 Q905.2153,476.1406 905.6372,475.7031 Q905.9028,475.4375 906.0435,475.3594 Q906.1997,475.2813 906.4028,475.2813 Q906.731,475.2813 906.981,475.5469 Q907.2466,475.7969 907.2466,476.1406 Q907.2466,476.4844 906.9028,476.8906 Q906.4028,477.4688 905.606,477.7969 Q904.5278,478.25 903.231,478.25 Q901.7153,478.25 900.5122,477.625 Q899.5278,477.125 898.8403,476.0625 Q898.1528,474.9844 898.1528,473.7031 L898.1528,472.5469 Q898.1528,471.2188 898.7622,470.0781 Q899.3872,468.9219 900.481,468.3125 Q901.5747,467.6875 902.8091,467.6875 Q903.5435,467.6875 904.1841,467.8594 Q904.8403,468.0156 905.3872,468.375 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="66.1309" x="923.1216" y="478.2969">SDFModel</text><line style="stroke:#181818;stroke-width:0.5;" x1="701.5" x2="1178.374" y1="488.5" y2="488.5"/><ellipse cx="711.5" cy="503.3105" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="142.4268" x="720.5" y="507.6074">encoder: PointEncoder</text><ellipse cx="711.5" cy="521.9316" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="173.5166" x="720.5" y="526.2285">decoder: NeuralImplicitField</text><ellipse cx="711.5" cy="540.5527" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="87.9443" x="720.5" y="544.8496">point_num: int</text><line style="stroke:#181818;stroke-width:0.5;" x1="701.5" x2="1178.374" y1="552.3633" y2="552.3633"/><ellipse cx="711.5" cy="567.1738" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="250.585" x="720.5" y="571.4707">__init__(point_num: int, feature_dim: int)</text><ellipse cx="711.5" cy="585.7949" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="440.4053" x="720.5" y="590.0918">forward(points: torch.Tensor, query_points: torch.Tensor): torch.Tensor</text><ellipse cx="711.5" cy="604.416" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="290.2471" x="720.5" y="608.7129">get_feature(points: torch.Tensor): torch.Tensor</text><ellipse cx="711.5" cy="623.0371" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="452.874" x="720.5" y="627.334">get_sdf(features: torch.Tensor, query_points: torch.Tensor): torch.Tensor</text><ellipse cx="711.5" cy="641.6582" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="127.6133" x="720.5" y="645.9551">freeze_model(): void</text></g><!--class FeatureExtractor--><g id="elem_FeatureExtractor"><rect codeLine="60" fill="#F1F1F1" height="178.3477" id="FeatureExtractor" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="820.8623" x="529.5" y="153"/><ellipse cx="883.5503" cy="169" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M886.3159,164.875 Q886.4722,164.6563 886.6597,164.5469 Q886.8472,164.4375 887.0659,164.4375 Q887.4409,164.4375 887.6753,164.7031 Q887.9097,164.9531 887.9097,165.5625 L887.9097,167.0156 Q887.9097,167.625 887.6753,167.8906 Q887.4409,168.1563 887.0659,168.1563 Q886.7222,168.1563 886.519,167.9531 Q886.3159,167.7656 886.2065,167.25 Q886.1597,166.8906 885.9722,166.7031 Q885.644,166.3281 885.0347,166.1094 Q884.4253,165.8906 883.8003,165.8906 Q883.0347,165.8906 882.394,166.2188 Q881.769,166.5469 881.269,167.2969 Q880.7847,168.0469 880.7847,169.0781 L880.7847,170.1719 Q880.7847,171.4063 881.6753,172.2344 Q882.5659,173.0469 884.1597,173.0469 Q885.0972,173.0469 885.7534,172.7969 Q886.144,172.6406 886.5659,172.2031 Q886.8315,171.9375 886.9722,171.8594 Q887.1284,171.7813 887.3315,171.7813 Q887.6597,171.7813 887.9097,172.0469 Q888.1753,172.2969 888.1753,172.6406 Q888.1753,172.9844 887.8315,173.3906 Q887.3315,173.9688 886.5347,174.2969 Q885.4565,174.75 884.1597,174.75 Q882.644,174.75 881.4409,174.125 Q880.4565,173.625 879.769,172.5625 Q879.0815,171.4844 879.0815,170.2031 L879.0815,169.0469 Q879.0815,167.7188 879.6909,166.5781 Q880.3159,165.4219 881.4097,164.8125 Q882.5034,164.1875 883.7378,164.1875 Q884.4722,164.1875 885.1128,164.3594 Q885.769,164.5156 886.3159,164.875 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="104.2617" x="904.0503" y="174.7969">FeatureExtractor</text><line style="stroke:#181818;stroke-width:0.5;" x1="530.5" x2="1349.3623" y1="185" y2="185"/><ellipse cx="540.5" cy="199.8105" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="96.4824" x="549.5" y="204.1074">rgb: RGBModel</text><ellipse cx="540.5" cy="218.4316" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="92.5859" x="549.5" y="222.7285">sdf: SDFModel</text><ellipse cx="540.5" cy="237.0527" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="120.6064" x="549.5" y="241.3496">bank: MemoryBank</text><line style="stroke:#181818;stroke-width:0.5;" x1="530.5" x2="1349.3623" y1="248.8633" y2="248.8633"/><ellipse cx="540.5" cy="263.6738" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="581.3008" x="549.5" y="267.9707">__init__(self, feature_dim: int, n_components: int, method: str, image_size: int, point_num: int)</text><ellipse cx="540.5" cy="282.2949" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="394.8848" x="549.5" y="286.5918">extract_rgb_features(self, image: torch.Tensor) -&gt; torch.Tensor:</text><ellipse cx="540.5" cy="300.916" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="708.4697" x="549.5" y="305.2129">extract_sdf_features(self, points: torch.Tensor, points_idx: torch.Tensor) -&gt; Tuple[torch.Tensor, List[torch.Tensor]]:</text><ellipse cx="540.5" cy="319.5371" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="794.8623" x="549.5" y="323.834">compute_anomaly_map(self, features: torch.Tensor, reference_features: torch.Tensor, method: str) -&gt; Tuple[torch.Tensor, float]:</text></g><!--class BaseFeatureExtractor--><g id="elem_BaseFeatureExtractor"><rect codeLine="71" fill="#F1F1F1" height="85.2422" id="BaseFeatureExtractor" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="619.7217" x="630" y="7"/><ellipse cx="867.5249" cy="23" fill="#A9DCDF" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M869.7124,24.7656 L865.5718,24.7656 L865.1499,25.7969 L865.5718,25.7969 Q866.1812,25.7969 866.4468,26.0313 Q866.7124,26.2656 866.7124,26.6563 Q866.7124,27.0313 866.4468,27.2656 Q866.1812,27.5 865.5718,27.5 L863.2749,27.5 Q862.6655,27.5 862.4155,27.2656 Q862.1499,27.0313 862.1499,26.6406 Q862.1499,26.2656 862.4312,26.0313 Q862.6968,25.7813 863.3218,25.7969 L865.9937,19.1406 L864.8843,19.1406 Q864.2749,19.1406 864.0093,18.9063 Q863.7437,18.6719 863.7437,18.2813 Q863.7437,17.9063 864.0093,17.6719 Q864.2749,17.4375 864.8843,17.4375 L868.5562,17.4375 L871.9468,25.7969 Q872.5405,25.7969 872.728,25.9375 Q873.1187,26.2031 873.1187,26.6563 Q873.1187,27.0313 872.853,27.2656 Q872.603,27.5 871.9937,27.5 L869.6968,27.5 Q869.0874,27.5 868.8218,27.2656 Q868.5562,27.0313 868.5562,26.6406 Q868.5562,26.2656 868.8218,26.0313 Q869.0874,25.7969 869.6968,25.7969 L870.1187,25.7969 L869.7124,24.7656 Z M868.9937,23.0625 L867.6343,19.6875 L866.2593,23.0625 L868.9937,23.0625 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="136.1719" x="888.0249" y="28.7969">BaseFeatureExtractor</text><line style="stroke:#181818;stroke-width:0.5;" x1="631" x2="1248.7217" y1="39" y2="39"/><line style="stroke:#181818;stroke-width:0.5;" x1="631" x2="1248.7217" y1="47" y2="47"/><ellipse cx="641" cy="61.8105" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="255.2266" x="650" y="66.1074">extract_features(data: Any): torch.Tensor</text><ellipse cx="641" cy="80.4316" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="593.7217" x="650" y="84.7285">compute_anomaly_map(features: torch.Tensor, reference_features: torch.Tensor): torch.Tensor</text></g><!--class MemoryBank--><g id="elem_MemoryBank"><rect codeLine="76" fill="#F1F1F1" height="290.0742" id="MemoryBank" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="634.9111" x="1214.5" y="410"/><ellipse cx="1486.4712" cy="426" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M1489.2368,421.875 Q1489.3931,421.6563 1489.5806,421.5469 Q1489.7681,421.4375 1489.9868,421.4375 Q1490.3618,421.4375 1490.5962,421.7031 Q1490.8306,421.9531 1490.8306,422.5625 L1490.8306,424.0156 Q1490.8306,424.625 1490.5962,424.8906 Q1490.3618,425.1563 1489.9868,425.1563 Q1489.6431,425.1563 1489.4399,424.9531 Q1489.2368,424.7656 1489.1274,424.25 Q1489.0806,423.8906 1488.8931,423.7031 Q1488.5649,423.3281 1487.9556,423.1094 Q1487.3462,422.8906 1486.7212,422.8906 Q1485.9556,422.8906 1485.3149,423.2188 Q1484.6899,423.5469 1484.1899,424.2969 Q1483.7056,425.0469 1483.7056,426.0781 L1483.7056,427.1719 Q1483.7056,428.4063 1484.5962,429.2344 Q1485.4868,430.0469 1487.0806,430.0469 Q1488.0181,430.0469 1488.6743,429.7969 Q1489.0649,429.6406 1489.4868,429.2031 Q1489.7524,428.9375 1489.8931,428.8594 Q1490.0493,428.7813 1490.2524,428.7813 Q1490.5806,428.7813 1490.8306,429.0469 Q1491.0962,429.2969 1491.0962,429.6406 Q1491.0962,429.9844 1490.7524,430.3906 Q1490.2524,430.9688 1489.4556,431.2969 Q1488.3774,431.75 1487.0806,431.75 Q1485.5649,431.75 1484.3618,431.125 Q1483.3774,430.625 1482.6899,429.5625 Q1482.0024,428.4844 1482.0024,427.2031 L1482.0024,426.0469 Q1482.0024,424.7188 1482.6118,423.5781 Q1483.2368,422.4219 1484.3306,421.8125 Q1485.4243,421.1875 1486.6587,421.1875 Q1487.3931,421.1875 1488.0337,421.3594 Q1488.6899,421.5156 1489.2368,421.875 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="82.4688" x="1506.9712" y="431.7969">MemoryBank</text><line style="stroke:#181818;stroke-width:0.5;" x1="1215.5" x2="1848.4111" y1="442" y2="442"/><ellipse cx="1225.5" cy="456.8105" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="194.5371" x="1234.5" y="461.1074">rgb_features: List[torch.Tensor]</text><ellipse cx="1225.5" cy="475.4316" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="192.9785" x="1234.5" y="479.7285">sdf_features: List[torch.Tensor]</text><ellipse cx="1225.5" cy="494.0527" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="159.5098" x="1234.5" y="498.3496">indices: List[torch.Tensor]</text><ellipse cx="1225.5" cy="512.6738" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="271.5918" x="1234.5" y="516.9707">rgb_features_tensor: Optional[torch.Tensor]</text><ellipse cx="1225.5" cy="531.2949" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="270.0332" x="1234.5" y="535.5918">sdf_features_tensor: Optional[torch.Tensor]</text><ellipse cx="1225.5" cy="549.916" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="236.5645" x="1234.5" y="554.2129">indices_tensor: Optional[torch.Tensor]</text><ellipse cx="1225.5" cy="568.5371" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="103.5098" x="1234.5" y="572.834">is_finalized: bool</text><line style="stroke:#181818;stroke-width:0.5;" x1="1215.5" x2="1848.4111" y1="580.3477" y2="580.3477"/><ellipse cx="1225.5" cy="595.1582" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="91.8271" x="1234.5" y="599.4551">__init__(): void</text><ellipse cx="1225.5" cy="613.7793" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="508.5391" x="1234.5" y="618.0762">add_features(features: torch.Tensor, indices: Optional[torch.Tensor] = None): void</text><ellipse cx="1225.5" cy="632.4004" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="608.9111" x="1234.5" y="636.6973">find_nearest_features(query_features: torch.Tensor, k: int = 10): Tuple[torch.Tensor, torch.Tensor]</text><ellipse cx="1225.5" cy="651.0215" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="86.3652" x="1234.5" y="655.3184">finalize(): void</text><ellipse cx="1225.5" cy="669.6426" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="149.3721" x="1234.5" y="673.9395">save(directory: str): void</text><ellipse cx="1225.5" cy="688.2637" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="352.0986" x="1234.5" y="692.5605">load(path: str, name: Optional[str] = None): MemoryBank</text></g><!--reverse link SDFModel to PointEncoder--><g id="link_SDFModel_PointEncoder"><path codeLine="57" d="M877.7175,664.0866 C855.4975,702.6366 835.6,737.19 811.65,778.74 " fill="none" id="SDFModel-backto-PointEncoder" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="883.71,653.69,877.2482,656.8908,877.7175,664.0866,884.1793,660.8858,883.71,653.69" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="69.3672" x="838" y="745.0283">composition</text></g><!--reverse link SDFModel to NeuralImplicitField--><g id="link_SDFModel_NeuralImplicitField"><path codeLine="58" d="M1002.2806,664.0877 C1033.1906,717.7377 1065.24,773.34 1095.24,825.4 " fill="none" id="SDFModel-backto-NeuralImplicitField" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="996.29,653.69,995.8194,660.8857,1002.2806,664.0877,1002.7512,656.892,996.29,653.69" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="69.3672" x="1051" y="745.0283">composition</text></g><!--reverse link FeatureExtractor to RGBModel--><g id="link_FeatureExtractor_RGBModel"><path codeLine="93" d="M758.2714,336.5737 C676.3014,378.7837 589.04,423.71 507.07,465.92 " fill="none" id="FeatureExtractor-backto-RGBModel" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="768.94,331.08,761.7745,330.2707,758.2714,336.5737,765.4369,337.3831,768.94,331.08" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="69.3672" x="711" y="376.0283">composition</text></g><!--reverse link FeatureExtractor to SDFModel--><g id="link_FeatureExtractor_SDFModel"><path codeLine="94" d="M940,343.29 C940,382.35 940,416.41 940,456.48 " fill="none" id="FeatureExtractor-backto-SDFModel" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="940,331.29,936,337.29,940,343.29,944,337.29,940,331.29" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="69.3672" x="941" y="376.0283">composition</text></g><!--reverse link FeatureExtractor to MemoryBank--><g id="link_FeatureExtractor_MemoryBank"><path codeLine="95" d="M1118.2837,336.66 C1165.0437,361.22 1206.47,382.98 1257.65,409.87 " fill="none" id="FeatureExtractor-backto-MemoryBank" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="1107.66,331.08,1111.1119,337.4112,1118.2837,336.66,1114.8319,330.3287,1107.66,331.08" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="69.3672" x="1201" y="376.0283">composition</text></g><!--reverse link BaseFeatureExtractor to FeatureExtractor--><g id="link_BaseFeatureExtractor_FeatureExtractor"><path codeLine="97" d="M940,110.31 C940,128.16 940,131.71 940,152.81 " fill="none" id="BaseFeatureExtractor-backto-FeatureExtractor" style="stroke:#181818;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/><polygon fill="none" points="940,92.31,934,110.31,946,110.31,940,92.31" style="stroke:#181818;stroke-width:1.0;"/></g><!--SRC=[fLRTRzCm47_lNs7jgMDT1HkyH82q3uQGjZ71U4B8SknhQosnW-sKTS3_pYLsqdoo3lhIvEvy7x_xtSKyOTQIJ-zFhxI0XFoS4FmTKW5hoI4Yv-M_5yQCtyLQeTJ9D9sdnG7hLMozf9dM2QgquQkvKlCJmJ8drt2oNjwWvaYKbWSTnrv8gLJIKJfjQsUa2aaLIr5idPaHdJiq5wYt62xF4hJZA-1tcPRAqOovLR0iCg9Oduj8Z8_xFjX2cn_CYEbzbUmjAAlDVaGIQLsmCG0FWBuCndLWx3HX6_ppDZCIzB4AdYEorb9CVayceF8qf1_0FBlvGjwGFPxbU_xzo_b9ASW5sokEyB85DqNsxnH7L4quUS2rMh-82A9vLZo9hVHeK7hSaowuFtyf5J1JoOvwibXvkrFc-EfQcxHo4AkZCSNncEBbcE9LJz7flrIKhvXIIAo881w8D32N6w12fgNaqIOsNxVeNaDkMF8XpHB9fRkGa8WAv5qXMl3Z0Hb5EZR5dO8UIJ-eRJljWhbeQ_zUM-be2Ouk3HCIbFilRpLIdyylcglW03mbenP1graEgW5qlOKVIHo9ilWkE6tjexqUAcD6lkTWDlH9W8KuqoSTic8n2l0JSmZReroWqyRkgA5_TdZOtWSHuJhDj9LEQjMs6s9sspmqzi8d_-xU6SOngQh1n2pZgFu211bM6zLK2BAOgRk8N46gpUOKdqCxITrF2ycYtyKPmQ4kqb5GmbEASAkkj0XxMgPi2TJA1mZQDZ423GZup2dcMxNGXfYbXmxovF1jIn1rt629NJV33FDIAiNzG8JRuWFqjNtW4hyHBT6tRrNm0eZS0MLAfopPq9HbRTXwqGqimE0G0XspQ60vcj8YqSnX5iWo5jiI0E9fSSeiZ56ZWgg6IJ378dAYDeEy7YhkNyiQtKzR_ZK9tF3IHt_BwLtCwhl5g4Kp7dMUNEHZLWmRInuDlTk9aCMEnfOk92fnWeI_aVHcirepNio4s3Prh4Kr4CEnyGvpZJFTTenf25fy2C4sQEFturYSktBAqTsBv-XiYBr3DLS5TogpR0rJ8GqKFDxueMWPu23WfsHxIVGtoxf4b3KgQomx961lJ3Jkt_hgt5wwWxRrujx1ji7ppZeVdDZNl-RptegV_040]--></g></svg>